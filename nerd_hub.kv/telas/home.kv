# telas/home.kv
#:import os os
#:import dp kivy.metrics.dp

<ImageButton@ButtonBehavior+Image>:
    allow_stretch: True
    keep_ratio: False

<Banner@BoxLayout>:
    size_hint_y: None
    height: dp(200)
    padding: dp(20), dp(10)
    spacing: 0
    orientation: 'horizontal'
    canvas.before:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size
            source: "imagens/imagens_home/banner_principal.png"
    Widget:
        size_hint_x: 0.5

<ProductCard@BoxLayout>:
    orientation: 'vertical'
    size_hint_y: None
    height: dp(290)
    padding: dp(8)
    spacing: dp(5)
    title: ''
    price: ''
    image: ''
    produto_id: 0

    canvas.before:
        Color:
            rgba: 1,1,1,1
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(12),]

    # Imagem real do produto
    Image:
        source: root.image if root.image else 'imagens/imagem_produtos_home/forza.jpg'
        allow_stretch: True
        keep_ratio: False
        size_hint_y: None
        height: dp(130)
        canvas.before:
            Color:
                rgba: 0.95,0.95,0.95,1
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [dp(8), dp(8), 0, 0]

    # Título do produto
    Label:
        text: root.title
        text_size: self.width, None
        halign: 'center'
        valign: 'middle'
        color: 0,0,0,1
        size_hint_y: None
        height: dp(40)
        font_size: '13sp'
        bold: True

    Label:
        text: root.price
        size_hint_y: None
        height: dp(22)
        halign: 'center'
        valign: 'middle'
        color: 0.07, 0.57, 0.38, 1
        font_size: '14sp'
        bold: True
    
    # Botão para ver detalhes
    Button:
        text: "Ver Detalhes"
        size_hint_y: None
        height: dp(34)
        background_normal: ''
        background_color: 0.2, 0.4, 0.6, 1
        color: 1,1,1,1
        font_size: '12sp'
        radius: [dp(8),]
        on_release: app.root.get_screen('home').ir_para_detalhes(root.produto_id)

    Button:
        text: "Adicionar ao Carrinho"
        size_hint_y: None
        height: dp(34)
        background_normal: ''
        background_color: 0.07,0.57,0.38,1
        color: 1,1,1,1
        font_size: '12sp'
        radius: [dp(8),]
        on_release: app.adicionar_ao_carrinho({'title': root.title, 'price': root.price, 'image': root.image, 'id': root.produto_id})


<HomeScreen>:
    canvas.before:
        Color:
            rgba: 0.85, 0.85, 0.85, 1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'
        padding: 0
        spacing: 0

        Header:

        ScrollView:
            do_scroll_x: False
            do_scroll_y: True
            bar_width: dp(4)
            bar_color: 0.07, 0.57, 0.38, 0.7
            bar_inactive_color: 0.07, 0.57, 0.38, 0.3
            scroll_type: ['bars', 'content']

            GridLayout:
                cols: 1
                spacing: 0
                size_hint_y: None
                height: self.minimum_height
                padding: 0

                # BANNER PRINCIPAL
                Banner:

                # SEÇÃO EXPLORAR MARCAS (COLADO COM O BANNER)
                BoxLayout:
                    size_hint_y: None
                    height: dp(32)
                    padding: dp(8), 0
                    canvas.before:
                        Color:
                            rgba: 0.07, 0.57, 0.38, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    Label:
                        text: "EXPLORAR MARCAS"
                        color: 1, 1, 1, 1
                        bold: True
                        font_size: '16sp'
                        halign: 'center'
                        valign: 'middle'
                        text_size: self.size

                Widget:
                    size_hint_y: None
                    height: dp(10)

                # CARROSSEL DE MARCAS
                BoxLayout:
                    size_hint_y: None
                    height: dp(180)
                    padding: dp(20), dp(5)

                    Carousel:
                        id: subbanner_carousel
                        direction: 'right'
                        loop: True
                        size_hint_y: None
                        height: dp(180)
                        anim_move_duration: 0.4
                        scroll_timeout: 200
                        spacing: dp(20)
                        padding: dp(10), 0

                        # ITEM DISNEY
                        FloatLayout:
                            size_hint: None, None
                            size: dp(360), dp(180)
                            canvas.before:
                                Color:
                                    rgba: 1, 1, 1, 1
                                RoundedRectangle:
                                    pos: self.pos
                                    size: self.size
                                    radius: [dp(16),]
                            ImageButton:
                                source: "imagens/imagens_home/banner_disney.png"
                                size_hint: 0.9, 0.9
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                canvas.before:
                                    Color:
                                        rgba: 1, 1, 1, 1
                                    RoundedRectangle:
                                        pos: self.pos
                                        size: self.size
                                        radius: [dp(12),]
                                on_release: app.root.current = "disney"

                        # ITEM XBOX
                        FloatLayout:
                            size_hint: None, None
                            size: dp(360), dp(180)
                            canvas.before:
                                Color:
                                    rgba: 1, 1, 1, 1
                                RoundedRectangle:
                                    pos: self.pos
                                    size: self.size
                                    radius: [dp(16),]
                            ImageButton:
                                source: "imagens/imagens_home/banner_xbox.png"
                                size_hint: 0.9, 0.9
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                canvas.before:
                                    Color:
                                        rgba: 1, 1, 1, 1
                                    RoundedRectangle:
                                        pos: self.pos
                                        size: self.size
                                        radius: [dp(12),]
                                on_release: app.root.current = "xbox"

                        # ITEM MARVEL
                        FloatLayout:
                            size_hint: None, None
                            size: dp(360), dp(180)
                            canvas.before:
                                Color:
                                    rgba: 1, 1, 1, 1
                                RoundedRectangle:
                                    pos: self.pos
                                    size: self.size
                                    radius: [dp(16),]
                            ImageButton:
                                source: "imagens/imagens_home/banner_marvel.png"
                                size_hint: 0.9, 0.9
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                canvas.before:
                                    Color:
                                        rgba: 1, 1, 1, 1
                                    RoundedRectangle:
                                        pos: self.pos
                                        size: self.size
                                        radius: [dp(12),]
                                on_release: app.root.current = "marvel"

                        # ITEM PLAYSTATION
                        FloatLayout:
                            size_hint: None, None
                            size: dp(360), dp(180)
                            canvas.before:
                                Color:
                                    rgba: 1, 1, 1, 1
                                RoundedRectangle:
                                    pos: self.pos
                                    size: self.size
                                    radius: [dp(16),]
                            ImageButton:
                                source: "imagens/imagens_home/banner_playstation.png"
                                size_hint: 0.9, 0.9
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                canvas.before:
                                    Color:
                                        rgba: 1, 1, 1, 1
                                    RoundedRectangle:
                                        pos: self.pos
                                        size: self.size
                                        radius: [dp(12),]
                                on_release: app.root.current = "playstation"

                        # ITEM STAR WARS
                        FloatLayout:
                            size_hint: None, None
                            size: dp(360), dp(180)
                            canvas.before:
                                Color:
                                    rgba: 1, 1, 1, 1
                                RoundedRectangle:
                                    pos: self.pos
                                    size: self.size
                                    radius: [dp(16),]
                            ImageButton:
                                source: "imagens/imagens_home/banner_starwars.png"
                                size_hint: 0.9, 0.9
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                canvas.before:
                                    Color:
                                        rgba: 1, 1, 1, 1
                                    RoundedRectangle:
                                        pos: self.pos
                                        size: self.size
                                        radius: [dp(12),]
                                on_release: app.root.current = "starwars"

                Widget:
                    size_hint_y: None
                    height: dp(15)

                # SEÇÃO DE PRODUTOS (BARRA VERDE)
                BoxLayout:
                    size_hint_y: None
                    height: dp(32)
                    padding: dp(8), 0
                    canvas.before:
                        Color:
                            rgba: 0.07, 0.57, 0.38, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                    Label:
                        text: "PRODUTOS EM DESTAQUE"
                        color: 1, 1, 1, 1
                        bold: True
                        font_size: '16sp'
                        halign: 'center'
                        valign: 'middle'
                        text_size: self.size

                # GRID DE PRODUTOS
                GridLayout:
                    id: products_grid
                    cols: 2
                    spacing: dp(12)
                    size_hint_y: None
                    height: self.minimum_height
                    row_default_height: dp(250)
                    padding: dp(15), dp(5), dp(15), dp(15)